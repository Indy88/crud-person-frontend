<p-card>
  <p-table #dt
  dataKey="id"
  [columns]="cols"
  [value]="personList"
  editMode="row"
  [globalFilterFields]="['fullname','cpf','email']"
  [rowHover]=true
  [loading]="loading"
  [showCurrentPageReport]="true"
  [paginator]="true"
  [rows]="5"
  [rowsPerPageOptions]="[5,10,15,20]">

  <ng-template pTemplate="caption">
    <div class="table-header">
<!--      class="p-button-success p-mr-2"-->
<!--      class="p-button-success p-button-outlined p-mr-2"-->
      <button  pButton  type="button" label="Add New" icon="pi pi-plus" class="p-button-success p-button-outlined p-mr-2" (click)="onAdd()"></button>
      People listing
        <span class="p-input-icon-left p-ml-auto">
            <i class="pi pi-search"></i>
            <input pInputText type="text" (input)="dt.filterGlobal($event.target.value, 'contains')" placeholder="Search" />
        </span>
    </div>
</ng-template>

  <ng-template pTemplate="header" let-columns>
    <tr>
      <th *ngFor="let col of columns">
        <div class="p-d-flex p-jc-between p-ai-center">
          {{col.header}}
          <p-columnFilter *ngIf="col.setFilter" [type]="col.type" [field]="col.field" display="menu" class="p-ml-auto"></p-columnFilter>
        </div>
      </th>
      <th>Actions</th>
    </tr>
  </ng-template>
  <ng-template pTemplate="body" let-rowData let-columns="columns" let-ri="rowIndex">
    <tr>
      <td *ngFor="let col of columns">
        {{rowData[col.field]}}
      </td>
      <td style="text-align:center">

        <p-button type="button" icon="pi pi-pencil"
                  styleClass="ui-button-info"
                  (click)="onEditRow(rowData)"></p-button>

        <p-button type="button" icon="pi pi-trash"
                  class="p-button-danger"
                  [style]="{marginLeft: '.5em'}"
                  (onClick)="deletePerson(rowData)">
        </p-button>
      </td>
    </tr>
  </ng-template>
</p-table>
</p-card>

<p-dialog [(visible)]="personDialog"
          [style]="{width: '60vw'}"
          header="Add Person" [modal]="true" styleClass="p-fluid">
  <ng-template pTemplate="content">
    <div class="grid">
      <div class="p-row p-d-flex">
           <div class="p-field p-md-6">
             <label for="fullname">FullName</label>
             <input type="text" [(ngModel)]="person.fullname" pInputText id="fullname"  [maxLength]="60" required autofocus />
             <small class="p-invalid" *ngIf="submitted && person.fullname == ''">FullName is required.</small>
           </div>

           <div class="p-field p-col-6">
             <label>DNI</label>
             <p-inputNumber [(ngModel)]="person.cpf" mode="decimal" inputId="cpf" [useGrouping]="false"
                            [maxlength]="11" [minlength]="11">
             </p-inputNumber>
             <small class="p-invalid" *ngIf="submitted && person.cpf== ''">DNI is required.</small>
           </div>
      </div>
      <div class="p-row">
        <div class="p-field p-col-6">
          <label for="email">Email</label>
          <input type="text" pInputText id="email" [(ngModel)]="person.email" required  pattern="[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,4}$"/>
          <small class="p-invalid" *ngIf="submitted && !person?.email == ''">Email is required.</small>
        </div>

        <div class="p-field p-col-6">
          <label for="phone">Phone</label>
          <p-inputMask  id="phone" [(ngModel)]="person.phone" mask="999 999 9999" placeholder="(999) 999-9999" required ></p-inputMask>
        </div>

      </div>

      <div class="p-row">
        <div class="p-field p-col-6">
          <label>Date Birth</label>
          <p-calendar [(ngModel)]="person.datebirth"  [maxDate]="maxDate" [readonlyInput]="true" inputId="min-max" required
          ></p-calendar>
        </div>

        <div class="p-field p-col-6" style="margin-top: 20px">
          <p-dropdown [options]="gender"
                      [(ngModel)]="person.sex"
                      (onChange)="onSelectGender($event)"
                      placeholder="Select a Gender" optionLabel="name" [showClear]="true"></p-dropdown>
          <small class="p-invalid" *ngIf="submitted && person?.sex == ''">Gender is required.</small>
        </div>
      </div>

      <div class="p-row" style="margin-top: 20px">
        <div class="p-field">
            <label>Description</label>
            <textarea id="float-input" rows="3" cols="30"  [(ngModel)]="person.description" pInputTextarea></textarea>
        </div>
      </div>

      <!--Fields Maps-->
<!--      <div pStyleClass="p-row" >-->
<!--        <div class="p-field p-col-6">-->
<!--          <label >Neighborhood</label>-->
<!--          <input type="text" [(ngModel)]="person.neighborhood" pInputText id="neighborhood" required />-->
<!--          <small class="p-invalid" *ngIf="submitted && person.neighborhood == ''">Neighborhood is required.</small>-->
<!--        </div>-->

<!--        <div class="p-field p-col-6">-->
<!--          <label >Number</label>-->
<!--          <input type="text" [(ngModel)]="person.codeNumber" pInputText id="codeNumber" required />-->
<!--          <small class="p-invalid" *ngIf="submitted && person.codeNumber == ''">Number is required.</small>-->
<!--        </div>-->
<!--      </div>-->

<!--      <div pStyleClass="p-row">-->
<!--        <div class="p-field p-col-6">-->
<!--          <label >City</label>-->
<!--          <input type="text" [(ngModel)]="person.city" pInputText id="city" required />-->
<!--          <small class="p-invalid" *ngIf="submitted && person.city == ''">City is required.</small>-->
<!--        </div>-->

<!--        <div class="p-field p-col-6">-->
<!--          <label >Address</label>-->
<!--          <input type="text" [(ngModel)]="person.address" pInputText id="address"  [maxLength]="60" required />-->
<!--          <small class="p-invalid" *ngIf="submitted && person.address == ''">FullName is required.</small>-->
<!--        </div>-->
<!--      </div>-->


    </div>
  </ng-template>

  <ng-template pTemplate="footer">
    <button pButton pRipple label="Cancel" icon="pi pi-times" class="p-button-text" (click)="hideDialog()"></button>
    <button pButton pRipple label="Save" icon="pi pi-check" class="p-button-text" (click)="onSavePerson()"></button>
  </ng-template>
</p-dialog>

<div style="margin-top: 3%">
  <button pButton pRipple type="button" label="Go to Maps" class="p-button-raised p-button-info" (click)="gotoMaps()"></button>
</div>
